% GA_LSSVM输入输出模块
function [id,iq] = GA_LSSVM(in1,in2,in3,in4,in5)
% ***********************************************************************************************************************
% omega1,displace_X2,displace_Y2为模块输入，imd,imq,ibd,ibq为模块输出的控制电流
% 编写于2020.12.8                                  written by benedicor_xu
% ********************************************************************************************************************************************************************************************************************
% 初始化输入输出训练集
% Xtrain = [-0.000118998912203172,0.000940520726533503,0.500161743679382,-0.00613751032285007,-0.00682047110504552;-0.000119518987368655,0.00166870642978948,0.500143215206409,-0.00620905086115907,0.418373966005480;-0.000119942785841219,0.00161358360295355,0.500125738149479,-0.00546320948224451,1.10451897558357;-0.000120410734410226,0.000983965836155662,0.500110938244055,-0.00473252646831111,-0.227704038904212;-0.000120749903756830,-1.98703116172100e-05,0.500096647613620,-0.00493472997784418,-0.342112598561738;-0.000120489481431907,-0.000898154510140275,0.500082305155460,-0.00443002740113861,0.839892462001804;-0.000119982218669398,-0.00168958690028653,0.500070264799932,-0.00360266375916895,0.0505454647106903;-0.000119524689030033,-0.00165140390915780,0.500059375489783,-0.00364616570419657,-0.00104775465029229;-0.000119043369295479,-0.000967140800981515,0.500047878001342,-0.00371228265425241,0.373089412509473;-0.000118719204002649,4.29842482004215e-05,0.500037795859357,-0.00288238848380527,1.13911285145425;-0.000118962718082645,0.000952465249418405,0.500029549365983,-0.00280908956038859,-0.0725408418551706;-0.000119457859630733,0.00167065414255560,0.500020654707328,-0.00311153211385531,0.268330701231782;-0.000119877636113565,0.00161278914944286,0.500012142179468,-0.00258438035754251,0.789504372304743;-0.000120346041559556,0.000987080904223391,0.500005659603381,-0.00206400943487194,-0.393642680056696;-0.000120668930318910,-1.76672064918859e-05,0.499999071982412,-0.00246502660780882,-0.422305291626009;-0.000120393359232113,-0.000906775295331309,0.499991858729162,-0.00214333241166862,0.291963293672624;-0.000119878000974985,-0.00168719638660361,0.499986429170771,-0.00148034651694270,-0.0242220280267406;-0.000119415391055640,-0.00164996148249368,0.499981675961381,-0.00167921718604905,-0.676272542874700;-0.000118926477752094,-0.000961881251804469,0.499975852776852,-0.00189747302231667,0.302910674362618;-0.000118637525395767,3.12605365202230e-05,0.499971013526021,-0.00119974757645877,1.02543572868365;-0.000118953831317478,0.000930387961533512,0.499967618279976,-0.00125307306043473,-0.202150161300324;-0.000119451981202682,0.00168441093226731,0.499963241209683,-0.00165472056628717,0.173546743635082;-0.000119856691793539,0.00160536036027352,0.499958971885242,-0.00122727709616914,0.0968423174139740;-0.000120354016136552,0.000961925502012413,0.499956343983611,-0.000879775885929759,-0.338308924969151;-0.000120643981364520,-1.08498726406290e-05,0.499953240374571,-0.00131189496567719,-0.413593210339164;-0.000120300891158370,-0.000912394677859095,0.499949532524752,-0.000985625938263065,0.471931558104344;-0.000119800594632057,-0.00171808980294554,0.499947325262920,-0.000500706739555541,-0.223859353270837;-0.000119373082676729,-0.00164014036715366,0.499945126416619,-0.000840061677274468,-0.0658805067886268;-0.000118844411034262,-0.000940306490660839,0.499941991908808,-0.000887582452712940,0.346034756246361;-0.000118593996863256,4.99418420522575e-05,0.499939982361452,-0.000357394951177291,0.835287338676749;-0.000118908080337591,0.000984540007028168,0.499938605896423,-0.000691197530863359,-0.186202034734554;-0.000119339378901169,0.00171496830801020,0.499936087482418,-0.000958024748673146,0.537023930360331;-0.000119778908227106,0.00157332543027025,0.499934267943528,-0.000462413288802275,0.0101149576889518;-0.000120348689703953,0.000938426619726024,0.499933470002130,-0.000501044791489226,-0.697667223361875;-0.000120558221327216,-1.86683382519386e-05,0.499931565546094,-0.000842523130836119,-0.325031144963799;-0.000120214542159009,-0.000987894768274194,0.499929711112948,-0.000288017312133470,0.286997226729551;-0.000119806941419227,-0.00175600928812514,0.499929262067717,-4.76669897044739e-05,-0.519660488119417;-0.000119346433986402,-0.00159876062254890,0.499927885310321,-0.000555006547277662,0.0796245301633253;-0.000118730804969419,-0.000923050624938596,0.499925980599361,-0.000267837001246158,0.447123604898321;-0.000118598942781582,5.10133892289679e-05,0.499925643698072,8.69341978663771e-05,0.608154446786262;-0.000118951367409709,0.00105934854957732,0.499925012500786,-0.000564213562013938,-0.0647255873899896;-0.000119331622114407,0.00173865216275822,0.499923136875140,-0.000631958244535848,0.935288788381318;-0.000119829096058371,0.00153529675079046,0.499922765923322,-1.53097733188598e-05,-0.151338990564773;-0.000120465860725988,0.000920273941500354,0.499922883963547,-0.000392790453434591,-0.856789402472375;-0.000120599174107644,-3.40294024795400e-05,0.499921329199992,-0.000672338694806657,-0.253715825565650;-0.000120250817971617,-0.00103709892114465,0.499920342899855,7.68505478689170e-05,0.219849320223956;-0.000119873144256299,-0.00176586331585711,0.499920811973337,0.000184322696431329,-0.652300916407731;-0.000119361439419552,-0.00156543444511679,0.499919859186403,-0.000428741940550973,0.0818725858841032;-0.000118703531691180,-0.000907819915953771,0.499918502285590,-2.49966580578877e-05,0.468961421818980;-0.000118626303561126,5.03862831557343e-05,0.499918822393915,0.000244181712344104,0.450986271109940];
% Y1 = [-0.00168946055415013;-0.00170992175385792;-0.00175982806411925;-0.00176901041880645;-0.00177647682297341;-0.00174842447045787;-0.00172540548585137;-0.00166190419275018;-0.00165605531609434;-0.00165695844084632;-0.00168908218782901;-0.00170970231000124;-0.00175954824946796;-0.00176879185377540;-0.00177625563403073;-0.00174813694603943;-0.00172508609537018;-0.00166138669473148;-0.00165611505024946;-0.00165706226358509;-0.00168932810978419;-0.00171059233162705;-0.00176026450255895;-0.00176955563391028;-0.00177606577492458;-0.00174794057283881;-0.00172053461533976;-0.00166027045823811;-0.00165443144922160;-0.00165730687754081;-0.00168912801368293;-0.00171631152474685;-0.00176152134208286;-0.00177176050664893;-0.00177571378669127;-0.00174815247971043;-0.00171380362367178;-0.00165901574086864;-0.00165216154143645;-0.00165775350308685;-0.00168888499997196;-0.00172227648425386;-0.00176301019401681;-0.00177361412476309;-0.00177541963731567;-0.00174802281708983;-0.00171073366253398;-0.00165796815713460;-0.00165160731185282;-0.00165984854493352];
% Y2 = [0.289582218502476;0.289627286500404;0.289314192696037;0.289582132264542;0.289553162895214;0.289567119189416;0.289502329986469;0.289787918317574;0.289506978844808;0.289534152846487;0.289517604807170;0.289567206381434;0.289258849216788;0.289530576254468;0.289505361835851;0.289522858073277;0.289461165316805;0.289750638462018;0.289471279172720;0.289501380871399;0.289487231208899;0.289532655185575;0.289231370982418;0.289504239483504;0.289482732407813;0.289501459407410;0.289476725411198;0.289734964507700;0.289459929678386;0.289486061168658;0.289474800050989;0.289468777015633;0.289216455771060;0.289486417817472;0.289472851959950;0.289489831719170;0.289523063189178;0.289728911334261;0.289459471814391;0.289478841754961;0.289470231550555;0.289406935951351;0.289207789223788;0.289476036763805;0.289468120903405;0.289484176295395;0.289540295609261;0.289705194302916;0.289457536892291;0.289469687331682];
% Y3 = [0;1.02437147955019;0.957739093404102;0.922614141552881;0.908524420746130;0.789141669674837;0.617082494142342;0.667116081238972;0.650189919129060;0.658714219293518;0.668314714597583;0.669026726095588;0.672042281332568;0.672845631938965;0.673084818984269;0.673051467940167;0.672977768782642;0.673083233046953;0.673094048638495;0.672891135677078;0.672939896903807;0.673042668962474;0.673121067730273;0.673216857842031;0.673225679766516;0.673158220870338;0.673285969199685;0.673322491607736;0.673338036617406;0.673353613436382;0.673394587371161;0.673384298927891;0.673366874700205;0.673419469783234;0.673472001294587;0.673431544249549;0.673510939479528;0.673525045538718;0.673530224244615;0.673512951152878;0.673559780427341;0.673567980684496;0.673610975063922;0.673614531195000;0.673629580724245;0.673577976230176;0.673600504093896;0.673613218255220;0.673616521635545;0.673667090707985;0.673608791086797;0.673639005413365;0.673670263086869;0.673603058936141;0.673632784351622;0.673649120373971;0.673645402698733;0.673659435484619;0.673633967456927;0.673641136367888;0.673692914383572;0.673673130859168;0.673671290464341;0.673658032313587;0.673653336506357;0.673669860360216;0.673701313562966;0.673710200112397;0.673686420548246;0.673648258194144;0.673752498869896;0.673709124481429;0.673684763348529;0.673678461672311;0.673686618482211;0.673674289647595;0.673695497217295;0.673680218679438;0.673688466055214;0.673712585851665;0.673697214834654;0.673716324604165;0.673679448308431;0.673710041164171;0.673688948898546;0.673690592521909;0.673666312778106;0.673689260005392;0.673670263022152;0.673711830906839;0.673712428739003;0.673699225767087;0.673685340674622;0.673676266570583;0.673702025682080;0.673704505079109;0.673722616995183;0.673677420546996;0.673688716184156;0.673688050070630;0.673733959862704];
% Y4 = [-1.90856457495240;-1.05963109961871;-1.08526115434242;-1.09538980560008;-1.08680146648687;-1.20682564692201;-1.32270773996307;-1.26522536751444;-1.27391589777802;-1.26685311860765;-1.25749625792142;-1.25691778440185;-1.25336965136958;-1.25279508981491;-1.25238311551840;-1.25153166178509;-1.25145894876379;-1.25154983973887;-1.25154203443749;-1.25124743832601;-1.25129728689858;-1.25140176366026;-1.25149614291849;-1.25152771961184;-1.25152233479554;-1.25139595757211;-1.25152748191659;-1.25157352486949;-1.25157065126734;-1.25158327710488;-1.25159255815908;-1.25160717354201;-1.25160595448570;-1.25168011308841;-1.25174478183824;-1.25170547608088;-1.25180309701349;-1.25183060567362;-1.25183618735843;-1.25182349507100;-1.25187811157286;-1.25188075398483;-1.25192572024225;-1.25194155239125;-1.25193900274084;-1.25191092497804;-1.25194688154615;-1.25195717169240;-1.25194064596498;-1.25198389843838;-1.25194536193682;-1.25198183377452;-1.25199447216065;-1.25197082957627;-1.25199542686586;-1.25200165537924;-1.25199620345669;-1.25201852673019;-1.25199358280500;-1.25203113741469;-1.25201899471899;-1.25208520299875;-1.25199661023573;-1.25201580452541;-1.25203130068294;-1.25205013994356;-1.25205264662131;-1.25202475768242;-1.25203402560162;-1.25199239358893;-1.25209671805526;-1.25206479187045;-1.25206390863554;-1.25206785534882;-1.25206487649307;-1.25207332458297;-1.25206032806246;-1.25210028594224;-1.25209207940257;-1.25212691592281;-1.25208227708279;-1.25207394817624;-1.25206855787590;-1.25206896884586;-1.25208626978587;-1.25209103319195;-1.25203687799656;-1.25207160343516;-1.25207014393923;-1.25207377432499;-1.25206921405073;-1.25209672222080;-1.25201506675087;-1.25204807062917;-1.25208742758218;-1.25208667757206;-1.25205981328418;-1.25210677082755;-1.25209958107605;-1.25207329087255;-1.25214018279911];
% 初始化拉格朗日乘子
alpha1 = [0.596300198140891;0.147847943161290;-0.944751070766422;-1.12609847085270;-1.29216369538788;-0.694990017978173;-0.354707045554337;1.24264461856094;1.32411361864179;1.30789752557621;0.603713661704261;0.151730520738636;-0.938834499964100;-1.09739591242715;-1.25419530100511;-0.677441079787816;-0.189199282448088;1.21112808960601;1.23266075960857;1.21461662563652;0.519442412980617;0.280152750645485;-0.887873270459017;-1.05512976753538;-1.12492077921348;-0.616206368077573;-0.215113386765393;1.14779427772359;1.14387023784987;1.04795132122601;0.150834294677601;0.00965782550833934;-0.447752879966979;-0.679392814281758;0.177160715882498;-0.207346156641889;0.00870483193831046;-0.891555955150647;-0.257570475937527;0.418698713223380;0.477806042347323;-0.122816349825165;-0.807884275400841;-0.894105678031099;-1.24739955272121;-0.520362212818537;0.127621220219581;1.75112331120789;1.39202742663091;0.859707355561751];
alpha2 = [0.700072195427854;1.08074722905068;-1.56385448950081;0.699237938699194;0.454485703659359;0.572533821479013;-0.0171990586309964;2.43785174679116;0.0645246810720629;0.294077780233379;0.154295541146787;0.573270505593051;-2.03132410907972;0.263836158735455;0.0508588220254462;0.198669764270906;-0.322448564554790;2.12266172705032;-0.234884072569835;0.0180566085858762;-0.0905345922302054;0.337212553610210;-2.18095671599641;0.0417561497681802;-0.124908716599137;0.0188319475760711;-0.213080614426200;1.73444963204056;-0.314439106112145;-0.105959893742513;-0.121723662546660;-0.256209929294454;-1.90050523320698;-0.0614530379107063;-0.0668545390973389;-0.0234928146491970;0.0816168583043879;0.752682640518173;-0.0879895834742870;-0.0839222430023547;-0.197592413576189;-0.779778943842478;-2.11628426755874;-0.180534278766792;-0.219194639403166;-0.116487878225929;0.314203198931507;0.942573522294495;-0.279414862706564;-0.217478466159528];
% alpha3 = [-7.71164814122271;3.42007347339714;1.96214201055430;0.723223203564645;1.99749713915294;1.20339616913090;-4.45260796759234;7.24743615786770;2.12369294240320;-10.2826137074698;7.53427151330652;-0.690374445586134;-2.50640665930244;-0.739853543960150;-1.18678650414205;1.06162605486692;1.05004021185017;0.483006057484802;0.181165694117667;0.332968472984491;-0.0383036567417644;-0.338606847507590;-0.372273851647318;-0.318224405283502;-0.180788133659863;-0.249757026922893;0.0969975912560843;0.226713922266572;0.224102581676146;0.174785273484460;0.193922851396742;-0.00785552140272742;-0.250750042987318;-0.126973658763755;0.0372727947433027;-0.253770335290546;0.101137828968180;0.111475125306185;0.0610047417642341;-0.129228249343415;0.0174724200256561;-0.0463660944723987;0.0950468028331249;0.0466038843920065;0.0926085823703683;-0.204665615480685;-0.0825218582729647;-0.0179238830555349;-0.0191369003771973;0.224700125611281;-0.138834197001289;-0.00659766078471529;0.150122648679526;-0.217812328304163;-0.0385749162701072;0.0613685282473008;0.0303493556118876;0.0730925166132449;-0.118416660968264;-0.127147473259932;0.130571767555983;0.0144574673701322;0.0138507220511346;-0.0539424744961843;-0.0920771056414081;-0.0336592268552076;0.0950437240286451;0.0990307861325369;-0.0702820998927508;-0.306757913675341;0.257127853355089;0.0268905809323505;-0.0762873082864970;-0.0654033189007545;0.0200735540731135;-0.0337988197498189;0.0665400051107263;-0.0588026120294019;-0.0579505103368896;0.0435197732216520;-0.0519932127045251;0.0640439211611641;-0.124169191624300;0.0594499057472556;-0.0398533669857581;0.00922532282815550;-0.0717078651651925;0.0732970047667028;-0.0978706621949943;0.0210556492989508;-0.0213899512684031;-0.0160723977467168;0.00888318402594763;-0.0575427353395832;-0.0138409129215347;-0.0268962558254336;0.105724191991693;-0.179644067841099;-0.0489012137601127;0.231976693049552;-0.226415272313023];
% alpha4 = [-8.44366351963848;2.42841675503786;1.21629735846888;-0.583776416145132;2.72277343710886;0.889197149351124;-11.8189004259019;16.5066297962633;6.41048387414972;-15.5072747008187;5.01951082585266;-0.105314575707964;-1.39813440784221;-0.125806972835069;-0.962020144907565;1.33926141723040;0.988422959275361;-0.357702595297240;-0.902962609704228;0.993774839306813;0.659941000465679;-0.162160377313398;-0.509657373649410;-1.03380652005200;-0.546149174966969;0.707821212653823;-0.100472114460373;-0.0676152203899912;0.134920509898680;0.236772156711251;0.149209697610898;0.294346693526875;0.481353848163653;0.0627649694460776;-0.287750394804145;0.158813073130959;-0.355360434060072;-0.327953023795900;-0.148978727885319;0.165716427665860;-0.000211519383532401;0.156597263616105;-0.00610146313609086;-0.00946296271850340;0.0578273631948850;0.272754953911773;0.0365662594758509;-0.0366847973685600;0.0745881439983173;-0.191036332950504;0.104204280175395;-0.0796858145432823;-0.0964338579271280;0.126630206255561;0.0233454473191091;0.0293059116292613;0.100285733301779;-0.0202437891425411;0.169315251422794;-0.0519194941143527;0.0592618746716994;-0.348168333496641;0.261802805526422;0.147830287370648;0.0459103590071839;-0.0856932289672632;-0.107158406677061;0.0847878956352652;0.0497230602384557;0.369118131802260;-0.267385180149710;-0.0101409556010524;0.0283537640227991;0.0220125689196702;0.0593781615389987;0.0325803564126087;0.166096900841705;-0.0418144875408488;0.0576432233504243;-0.161584344116271;0.104301995137291;0.103608557374733;0.0858101284440558;0.0555650099284860;-0.0603846645131957;-0.0883929036579464;0.256576653687772;-0.00246337536021325;-0.00506866372384446;0.00344624342440570;0.0910057748279412;-0.0838826115172010;0.353137660251462;-0.0250450549155033;-0.309609828405174;-0.0383225855440280;0.542119326580747;0.269639002380434;-0.332204098351533;-0.700758597355578;0.937758524358641];
% 初始化回归偏置b
b1 = -0.0381869602472909;
b2 = -0.0102180165469293;
% b3 = 0.0622561504996738;
% b4 = -0.383686750550780;
% 初始化核宽度
sig21 = 0.125000000000000;
sig22 = 0.0625000000000000;
% sig23 = 0.156250000000000;
% sig24 = 0.312500000000000;
% 输入初始化
Xt = [in1,in2,in3,in4,in5];
% 分配输出空间
% coder.varsize('imd');
% coder.varsize('imq');
% coder.varsize('ibd');
% coder.varsize('ibq');

% imd = zeros(1,1);
% imq = zeros(1,1);
% ibd = zeros(1,1);
% ibq = zeros(1,1);

% **************************************************************************************************************************
% 输入输出训练集预处理
% **************************************************************************************************************************************
% 输入训练集和输入测试集预处理

%Xmean = zeros(1, 5);
%Xstd = zeros(1, 5);
%for i = 1:size(Xtrain,2)
    %Xmean(i) = mean(Xtrain(:,i));
    %Xstd(i) = std(Xtrain(:,i));
    %Xtrain(:,i) = (Xtrain(:,i) - Xmean(i))./Xstd(i);
   % Xt(:,i) = (Xt(:,i) - Xmean(i))./Xstd(i);
%end
Xmean = [-0.000119634820108672,7.24399142382613e-07,0.499979182625402,-0.00167669229499178,0.110708513654667];
Xstd = [6.69844815938252e-07,0.00122293904916122,6.66583163875408e-05,0.00172186777990441,0.489166826800898];
Xtrain = [0.949336160210607,0.768473562141710,2.73875885071062,-2.59068557987997,-0.240263603990362;0.172924739074889,1.36391264290000,2.46079694022236,-2.63223379812526,0.628958129403242;-0.459756835045198,1.31883858391584,2.19860824604059,-2.19907546412358,2.03163912080532;-1.15834934165667,0.803998725600965,1.97658185494433,-1.77472057319580,-0.691814191023671;-1.66468952453757,-0.0168403411222480,1.76219554563799,-1.89215323085567,-0.925698733861022;-1.27590943887217,-0.735015297695475,1.54703172306819,-1.59903979752713,1.49066516451233;-0.518625437504653,-1.38217133600260,1.36640376573963,-1.11853621204532,-0.122990860474815;0.164412825207191,-1.35094901862307,1.20304365196594,-1.14380060547630,-0.228462483925646;0.882966918784549,-0.791425542252271,1.03055972101670,-1.18219899519442,0.536383263294346;1.36690780347429,0.0345559732408771,0.879308646412139,-0.700225768136754,2.10235911647003;1.00336975077636,0.778240625261572,0.755595750243121,-0.657656341917076,-0.374615254898355;0.264181305472858,1.36550529199192,0.622159156926943,-0.833304296421173,0.322225831641013;-0.362495908180001,1.31818895750049,0.494455243576371,-0.527153172353990,1.38765717840953;-1.06177047871602,0.806545923737999,0.397204421198071,-0.224940117005769,-1.03104128505559;-1.54380564816305,-0.0150388571261035,0.298377728206818,-0.457836729403698,-1.08963604250626;-1.13241023203070,-0.742064533057570,0.190165375406820,-0.271008100693276,0.370537759486564;-0.363040603624865,-1.38021660760909,0.108711797140085,0.114030694075696,-0.275837473615781;0.327581923171926,-1.34976954310864,0.0374047247802778,-0.00146636756128396,-1.60881935039656;1.05747232750563,-0.787124797108306,-0.0499539851983618,-0.128221649711773,0.392917406041071;1.48884441466922,0.0249694679377392,-0.122551840848761,0.276992649551457,1.86996984446228;1.01663665223703,0.760187977502851,-0.173486911355124,0.246023091610766,-0.639574594624610;0.272957111317926,1.37675424975572,-0.239151190475915,0.0127604041152497,0.128459712592063;-0.331228486939062,1.31211441995552,-0.303199079356788,0.261004476689602,-0.0283465588445088;-1.07367558987946,0.785976294999566,-0.342622541775891,0.462820907831994,-0.917922913048596;-1.50655977599032,-0.00946430796444848,-0.389182509206594,0.211861406300802,-1.07182600141288;-0.994366208186941,-0.746659514738497,-0.444807223720167,0.401346935458121,0.738445505007032;-0.247481983051554,-1.40547822335611,-0.477920298751108,0.682970881481691,-0.683954529610163;0.390743386699472,-1.34173879509487,-0.510907125004780,0.485885517739205,-0.360999582899291;1.17998834297564,-0.769483066591623,-0.557930632060556,0.458287129527824,0.481075636569028;1.55382742487589,0.0402452133192015,-0.588077618437105,0.766201307215197,1.48125094614603;1.08493751655427,0.804468226409612,-0.608727180315545,0.572340556940516,-0.606971961551413;0.441059183370657,1.40174108435213,-0.646508122611810,0.417376731655046,0.871513343400091;-0.215106715773225,1.28591938593053,-0.673804624963049,0.705210365372488,-0.205642636528702;-1.06572384871157,0.766761206314234,-0.685775245303546,0.682774552856677,-1.65255633196396;-1.37853006632708,-0.0158574848089299,-0.714345664407916,0.484455992435127,-0.890779249010322;-0.865457247026961,-0.808396107798374,-0.742165646167747,0.806493389948560,0.360385666844569;-0.256956994306374,-1.43648507133075,-0.748902168410349,0.946080369410095,-1.28865852555177;0.430526765913471,-1.30790248523696,-0.769556116343453,0.651435470716797,-0.0635447495379606;1.34958891633213,-0.755372906535750,-0.798130359787233,0.818213401858204,0.687730796145304;1.54644374703242,0.0411214198459662,-0.803184512175644,1.02425198580350,1.01692491370447;1.02031497848570,0.865639339230370,-0.812653657515655,0.646088361697319,-0.358638590012283;0.452639159176154,1.42110742543370,-0.840791566596870,0.606744642445153,1.68568314437699;-0.290031280494538,1.25482324953201,-0.846356540902978,0.964872298014166,-0.535701707193034;-1.24064648638380,0.751917720665362,-0.844585715724959,0.745644849471812,-1.97784858481590;-1.43966777979975,-0.0284182614380980,-0.867910090525735,0.583293102935510,-0.744989887404295;-0.919612794319202,-0.848630453822572,-0.882706445886299,1.01839575798209,0.223115715517871;-0.355790090415768,-1.44454273188115,-0.875669462244617,1.08081178656263,-1.55981433788633;0.408125408475204,-1.28065159529688,-0.889963056586568,0.724765495356493,-0.0589490664343455;1.39030473227944,-0.742918721680608,-0.910319118464195,0.959246497443366,0.732373678131959;1.50559730186636,0.0406086338051052,-0.905516892090029,1.11557578912506,0.695627215117294];
for i = 1:size(Xtrain,2)
    Xt(:,i) = (Xt(:,i) - Xmean(i))./Xstd(i);
end
% ***********************************************************************************************************
% 最小二乘支持向量机输出拟合函数
[nb_data,d] = size(Xtrain);
XXh1 = sum(Xtrain.^2,2)*ones(1,size(Xt,1));
XXh2 = sum(Xt.^2,2)*ones(1,nb_data);
kx = XXh1+XXh2' - 2*Xtrain*Xt';
kx1 = exp(-kx./(2*sig21));
kx2 = exp(-kx./(2*sig22));
% kx3 = exp(-kx./(2*sig23));
% kx4 = exp(-kx./(2*sig24));
id = kx1'*alpha1+ones(size(kx1,2),1)*b1;
iq = kx2'*alpha2+ones(size(kx2,2),1)*b2;
% ibd = kx3'*alpha3+ones(size(kx3,2),1)*b3;
% ibq = kx4'*alpha4+ones(size(kx4,2),1)*b4;
% ****************************************************************************************************
% 测试集输出后处理参数
% Y1mean = mean(Y1);
% Y1std = std(Y1);
% Y2mean = mean(Y2);
% Y2std = std(Y2);
Y1mean = -0.00171495222254929;
Y1std = 4.60241341607557e-05;
Y2mean = 0.289500544182569;
Y2std = 0.000119337128635020;
% Y3mean = mean(Y3);
% Y3std = std(Y3);
% Y4mean = mean(Y4);
% Y4std = std(Y4);
% 测试集输出后处理
id = id.*Y1std+Y1mean;
iq = iq.*Y2std+Y2mean;
% ibd = ibd.*Y3std+Y3mean;
% ibq = ibq.*Y4std+Y4mean;
% **************************************************************************************************************